version: 2

models:
  - name: mart_owner_performance
    description: Sales performance metrics by opportunity owner
    columns:
      - name: owner_id
        description: The unique identifier for the opportunity owner
        tests:
          - unique
          - not_null
      - name: win_rate
        description: Ratio of won opportunities to total closed opportunities
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              arguments:
                min_value: 0
                max_value: 1
      - name: average_deal_size
        description: Average amount of won opportunities
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              arguments:
                min_value: 0
                max_value: 10000000

  - name: mart_manager_performance
    description: Sales performance metrics rolled up to the manager level
    columns:
      - name: manager_id
        description: The unique identifier for the manager
        tests:
          - unique
          - not_null
      - name: team_size
        description: Number of sales representatives reporting to this manager
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              arguments:
                min_value: 0
                max_value: 100

  - name: mart_sales_snapshot
    description: Single-row KPI dashboard with current sales metrics
    columns:
      - name: snapshot_id
        description: Always 1, used as the primary key for this single-row table
        tests:
          - unique
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_set:
              arguments:
                value_set: [1]
      - name: snapshot_date
        description: The date when this snapshot was generated
        tests:
          - not_null